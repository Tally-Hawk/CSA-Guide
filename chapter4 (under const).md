# Introduction to Bash Scripting
### (Conditional Execution) اجرای شرطی

این صفحه به صورت عملی و تصویری به آموزش **اجرای شرطی** در اسکریپت‌نویسی بش می‌پردازد. هدف اصلی این درس، یادگیری چگونگی کنترل جریان اجرای اسکریپت با استفاده از دستورات `if`، `elif`، `else` و ترکیب آن‌ها با عملگرهای مقایسه است.

اجرای شرطی یکی از مهم‌ترین بخش‌های برنامه‌نویسی است؛ بدون آن، اسکریپت فقط می‌تواند دستورات را به‌ترتیب از بالا به پایین اجرا کند و هیچ انعطافی در تصمیم‌گیری ندارد. در این درس با مثال‌های واقعی و خروجی‌های رنگی ترمینال، تمام مفاهیم به‌صورت گام‌به‌گام توضیح داده شده‌اند.

### **مفاهیم کلیدی که در این درس یاد می‌گیرید**

- **شبنگ (Shebang)** در واقع ترکیبی از دو کاراکتر # و ! است که دقیقاً در خط اول یک فایل اسکریپت قرار می‌گیرد و به سیستم‌عامل لینوکس/یونیکس می‌گوید:
«این فایل یک اسکریپت است و باید با چه برنامه‌ای (مفسر یا Interpreter) اجرا شود».

`#!/bin/bash`

- **متغیرهای ویژه (Special Parameters)**  
  ```bash
  $0  → نام اسکریپت
  $#  → تعداد آرگومان‌های ورودی
  $1, $2, ... → آرگومان‌های اول، دوم و ...
  ```

- **عملگرهای تست (Test Operators)**  
  ```bash
  [ $# -eq 0 ]      → آیا هیچ آرگومانی داده نشده؟
  [ "$var" -gt 10 ] → آیا مقدار عددی بزرگتر از ۱۰ است؟
  [ -z "$var" ]     → آیا رشته خالی است؟
  ```

- **ساختار کامل دستور `if`**  
  ```bash
  if [ شرط ]; then
      دستورات در صورت درست بودن
  elif [ شرط دوم ]; then
      دستورات
  else
      دستورات در صورت درست نبودن همه شرط‌ها
  fi
  ```
  نکته مهم: بعد از `[` و قبل از `]` حتماً فاصله (space) لازم است!

### **مثال‌های عملی درس (با توضیحات بیشتر)**

#### 1. **بررسی وجود آرگومان (Script.sh)**
```bash
#!/bin/bash
if [ $# -eq 0 ]; then
    echo "You need to specify the target domain."
    echo "Usage:"
    echo -e "\t$0 <domain>"
    exit 1
else
    domain=$1
fi
```
این کد چک می‌کند که آیا کاربر دامنه را وارد کرده یا نه. اگر نه، پیام خطای خوانا نمایش می‌دهد و با کد خروج ۱ (خطا) اسکریپت را متوقف می‌کند.

#### 2. **If-Only.sh – فقط یک شرط**
```bash
if [ $value -gt 10 ]; then
    echo "Given argument is greater than 10."
fi
```
اگر شرط درست باشد اجرا می‌شود، در غیر این صورت هیچ کاری نمی‌کند.

#### 3. **If-Else.sh – دو حالت**
```bash
if [ $value -gt 10 ]; then
    echo "Greater than 10"
else
    echo "10 or less"
fi
```

#### 4. **If-Elif-Else.sh – چندین شرط**
```bash
if [ $value -gt 10 ]; then
    echo "Given argument is greater than 10."
elif [ $value -lt 10 ]; then
    echo "Given argument is less than 10."
else
    echo "Given argument is not a number."
fi
```

#### 5. **چند شرط ترکیبی واقعی (Several Conditions)**
```bash
if [ $# -eq 0 ]; then
    echo "No domain given"
    exit 1
elif [ $# -eq 1 ]; then
    domain=$1
else
    echo "Too many arguments given."
    exit 1
fi
```
این الگو در اسکریپت‌های حرفه‌ای بسیار رایج است: دقیقاً یک آرگومان می‌خواهیم، نه کمتر و نه بیشتر.

### **جمع‌بندی و نکات پیشرفته اضافی**

- همیشه از نقل‌قول دور متغیرها استفاده کنید: `[ "$var" = "something" ]` تا از خطاهای ناخواسته جلوگیری شود.
- برای مقایسه رشته‌ها از `=` یا `==` و برای اعداد از `-eq`, `-ne`, `-lt`, `-gt`, `-le`, `-ge` استفاده کنید.
- می‌توانید چندین شرط را با `&&` (و) و `||` (یا) ترکیب کنید:
  ```bash
  if [ $# -eq 1 ] && [ -n "$1" ]; then
  ```
- برای خوانایی بیشتر، از ساختار `[[ ]]` (bash-only) استفاده کنید که نیازی به نقل‌قول اجباری ندارد.


## **آرگومان‌ها (Arguments)**، **متغیرها (Variables)** و **آرایه‌ها (Arrays)**

#### **بخش اول: آرگومان‌های خط فرمان (Arguments)**
در این بخش توضیح می‌دهد که در بش می‌توانیم تا **۹ آرگومان** را مستقیماً با متغیرهای خاص `$1` تا `$9` دریافت کنیم (`$0` هم نام خود اسکریپت است).  
برای دسترسی به آرگومان‌های بیشتر از ۹ تا (مثلاً `$10` به بعد) باید از `${10}` استفاده کنیم چون `$10` به اشتباه به `$1` + `0` تفسیر می‌شود.

**مثال عملی ارائه شده:**
```bash
./script.sh ARG1 ARG2 ... ARG1000
```
سپس یک اسکریپت واقعی به نام `cidr.sh` نشان می‌دهد که چگونه بررسی کنیم آیا آرگومان داده شده یا نه:
```bash
#!/bin/bash
if [ $# -eq 0 ]; then
    echo "You need to specify the target domain."
    echo "Usage: $0 <domain>"
    exit 1
else
    domain=$1
fi
```
همچنین نحوه اعطای مجوز اجرا با `chmod +x cidr.sh` و اجرای اسکریپت را نشان می‌دهد.

#### **بخش دوم: متغیرهای خاص (Special Variables)**
جدول مهمی از متغیرهای ویژه بش ارائه شده است:

| متغیر خاص | توضیح |
|-----------|-------|
| `$#`      | تعداد آرگومان‌های ارسالی |
| `$@`      | تمام آرگومان‌ها به صورت لیست |
| `$*`      | تمام آرگومان‌ها به صورت یک رشته |
| `$1`, `$2`, ... | آرگومان‌های اول، دوم و ... |
| `$$`      | PID پروسه جاری |
| `$?`      | وضعیت خروج آخرین دستور (0 = موفقیت) |

**نکته مهم:** در اسکریپت `cidr.sh` از `$#` برای چک کردن تعداد آرگومان‌ها و از `$0` در پیام Usage استفاده شده است.

#### **بخش سوم: متغیرها (Variables)**
تفاوت مهم بین **اعلان** و **استفاده** از متغیرها:
```bash
domain=$1          # اعلان → بدون $ و بدون فاصله اطراف =
echo $domain       # استفاده → با $
echo ${domain}     # روش بهتر و امن‌تر
```
هشدار مهم: در بش **هیچ نوع داده‌ای (type) وجود ندارد**؛ همه چیز به صورت رشته (string) در نظر گرفته می‌شود.  
همچنین اگر فاصله در اعلان متغیر بگذارید خطا می‌گیرید:
```bash
# اشتباه
variable = "test"    → command not found

# درست
variable="test"
```

#### **بخش چهارم: آرایه‌ها (Arrays)**
در بش دو نوع آرایه داریم اما در این درس فقط از **آرایه‌های اندیس‌دار (indexed arrays)** استفاده شده:
```bash
#!/bin/bash
domains=(www.inlanefreight.com ftp.inlanefreight.com vpn.inlanefreight.com www2.inlanefreight.com)

echo ${domains[0]}    # → www.inlanefreight.com
echo ${domains[3]}    # → www2.inlanefreight.com
echo ${domains[@]}    # تمام عناصر آرایه
echo ${#domains[@]}   # تعداد عناصر آرایه
```
**نکات کلیدی آرایه‌ها:**
- اندیس از صفر شروع می‌شود.
- برای دسترسی به عناصر باید از `{}` استفاده کنیم: `${domains[3]}`
- اگر مقدار داخل آرایه فاصله داشته باشد و داخل کوتیشن نباشد، به چند عنصر جدا می‌شود.
- برای چاپ مقدار چهارم (یعنی `www2.inlanefreight.com`) دستور صحیح این است:
```bash
echo ${domains[3]}
```


